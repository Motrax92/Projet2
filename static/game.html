<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Puissant pas Quatre</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/style/style.css">
</head>
<body>

  <!-- VidÃ©o de fond -->
  <video class="background-video" autoplay muted loop playsinline preload="auto">
    <source src="/static/284566_large.mp4" type="video/mp4">
  </video>

  <!-- Contenu principal -->
  <div class="page-content">

    <div class="top-band"><h2>Puissant pas Quatre</h2></div>

    <header class="site-header">
      <div class="brand"><span></span></div>
      <nav class="nav">
        <a href="/index">Accueil</a>
        <a href="/regle">RÃ¨gles</a>
        <a href="/contact">Contact</a>
      </nav>
    </header>

    <main>

      <div class="board-wrap">
        <div class="button-row">
          <button onclick="play(0)">â†“</button>
          <button onclick="play(1)">â†“</button>
          <button onclick="play(2)">â†“</button>
          <button onclick="play(3)">â†“</button>
          <button onclick="play(4)">â†“</button>
          <button onclick="play(5)">â†“</button>
          <button onclick="play(6)">â†“</button>
        </div>

        <!-- Bouton Reset (POST /reset) -->
        <div class="button-row">
          <form action="/reset" method="post">
            <button class="reset-btn" type="submit">â†º Reset</button>
          </form>
        </div>

        <div id="board" class="board"></div>
      </div>

      <p id="message"></p>
    </main>

  </div>

  <script>
    const ROWS = 6, COLS = 7;
    let grid = Array.from({length: COLS}, () => Array(ROWS).fill(" "));
    let currentPlayer = "ðŸ”´", gameOver = false;

    function renderGrid(){
      const board = document.getElementById("board");
      board.innerHTML = "";
      for (let y = 0; y < ROWS; y++){
        const row = document.createElement("div");
        row.className = "row";
        for (let x = 0; x < COLS; x++){
          const cell = document.createElement("div");
          cell.className = "cell";
          if (grid[x][y] === "ðŸ”´") cell.classList.add("x");
          if (grid[x][y] === "ðŸŸ¡") cell.classList.add("o");
          row.appendChild(cell);
        }
        board.appendChild(row);
      }
    }

    function play(col){
      if (gameOver) return;
      for (let r = ROWS - 1; r >= 0; r--){
        if (grid[col][r] === " "){
          grid[col][r] = currentPlayer;
          if (checkWin(col, r)){
            document.getElementById("message").textContent = `Le joueur ${currentPlayer} a gagnÃ© !`;
            gameOver = true;
          } else {
            currentPlayer = currentPlayer === "ðŸ”´" ? "ðŸŸ¡" : "ðŸ”´";
            document.getElementById("message").textContent = `Ã€ toi de jouer : ${currentPlayer}`;
          }
          renderGrid();
          return;
        }
      }
      alert("Colonne pleine !");
    }

    function checkWin(c, r){
      const dirs = [
        [[0,1],[0,-1]],
        [[1,0],[-1,0]],
        [[1,1],[-1,-1]],
        [[1,-1],[-1,1]]
      ];
      for (const dir of dirs){
        let count = 1;
        for (const [dx,dy] of dir){
          let x = c, y = r;
          while (true){
            x += dx; y += dy;
            if (x < 0 || x >= COLS || y < 0 || y >= ROWS) break;
            if (grid[x][y] === currentPlayer) count++;
            else break;
          }
        }
        if (count >= 4) return true;
      }
      return false;
    }

    renderGrid();
    document.getElementById("message").textContent = `Ã€ toi de jouer : ${currentPlayer}`;
  </script>
</body>
</html>
